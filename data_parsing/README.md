# README for NTEP Data Processing Program

## Overview

This Python program processes agricultural data from the NTEP Report (National Turfgrass Evaluation Program) and outputs a cleaned, tabular version of the data to a new file. The program uses the `pandas` library for data manipulation and automates the assignment of plot IDs (`plt_id`) for each entry using data from `entity_data.json`. It is designed to handle specific data formats for NTEP reports from 2019 to 2023.

## Features

- Reads and processes data from specified columns in an Excel file.
- Automatically assigns **row**, **column**, and **plot ID (plt_id)** to each entry using a preloaded queue from `entity_data.json`.
- Extracts additional parameters (e.g., soil pH, irrigation practice) from specific cells in the Excel file.
- Combines and formats unique identifiers (`number1`, `number2`, `number3`) into a new **Entry Code**.
- Outputs the cleaned and modified data to a new CSV file for analysis.

## Data Format

The program expects the input Excel file to have the following structure:

- The data begins on **row 7** (first 6 rows are skipped during parsing).
- Columns **A to BU** (0 to 72) are used, corresponding to predefined parameter names.
- Specific parameters are extracted from designated cells (e.g., soil pH from `BE3`, irrigation from `CA3`).
- **Reports from 2021 to 2023** are fully compatible with this program.
- Reports from **2019 and 2020** require manual editing to remove extra rows or columns so that the top-left cell (`A1`) reads: `National Turfgrass Evaluation Program`.

## File Structure

- `./data/`: Stores the raw NTEP reports (2019â€“2023), plot plans, and quality rating collection dates.
- `./parsed_data.zip`: Contains the processed datasets, including all extracted parameters and assigned plot IDs.
- `entity_data.json`: Stores the mapping of `row`, `column`, and `plot_id` for each entry to ensure consistency in future reports.
- `parse.py`: The main script for parsing and processing the data.

## Parameters Extracted

The following parameters are extracted and included in the processed output:

- **Genetic Color**
- **Greenup**
- **Leaf Texture**
- **Traffic Designation**
- **Wear Tolerance**
- **Seedling Vigor**
- **Spring Density**
- **Summer Density**
- **Fall Density**
- **Percent Living Ground Cover**:
  - **Spring Percent Living Ground Cover 1 & 2**
  - **Summer Percent Living Ground Cover 1 & 2**
  - **Fall Percent Living Ground Cover 1 & 2**
- **Frost Tolerance**
- **Winter Color**
- **Winter Kill 1 & 2**
- **Wilting**
- **Dormancy**
- **Recovery**
- **Thatch Measurements 1 & 2**
- **Disease Ratings**:
  - Typhula Blight
  - Microdochium Patch
  - Spring and Fall Melting Out
  - Leaf Spot
  - Stem Rust
  - Dollar Spot
  - Red Thread
  - Brown Patch (Warm Temp)
  - Summer Patch
  - Pythium Blight
  - Stripe Smut
  - Necrotic Ring Spot
  - Crown Rust
  - Powdery Mildew
  - Anthracnose
  - Brown Patch (Cool Temp)
  - Damping Off
  - Fairy Ring
  - Gray Leaf Spot
  - Pink Snow Mold
  - Pink Patch
  - Pythium Root Rot
  - Take All Patch
- **Insect Damage** (optional manual input)
- **Fall Color Retention**:
  - **September, October, November, December**
- **Seedheads**
- **Poa Annua Invasion**
- **Mowing Quality**
- **Quality ratings**

## Output

The processed data is saved as a CSV file (`{Year}parsed_data.csv`). The output includes:

1. **Entry Code**: A unique identifier created by concatenating `number1`, `number2`, and `number3`.
2. **Row** and **Column**: Assigned using the preloaded `entity_data.json` queue.
3. **Plot ID (plt_id)**: Generated by combining `row` and `column` (formatted as two-digit numbers).
4. All extracted parameters described above.

### Example Output (Columns)

| entity_name | entry_code | row | column | plt_id | genetic_color | greenup | ... |
|-------------|------------|-----|--------|--------|---------------|---------|-----|
| EntityA     | 001        | 01  | 01     | 1      | 6             | 5       | ... |
| EntityB     | 002        | 01  | 02     | 2      | 7             | 6       | ... |

## Manual Input Notes

- **Blank Columns**: Certain parameters, such as insect damage and drought data, may have missing or inconsistent values in the source files. These should be reviewed and filled manually after processing.
- **2019 and 2020 Reports**: Earlier reports require manual adjustments to remove extra rows and columns before running the program.

## Inconsistencies Handled

1. **Extra Columns**: Columns not matching expected headers will be ignored.
2. **Missing Plot Data**: For 2021, 2022 and 2023, where plot data is missing, `entity_data.json` is used to assign row and column numbers.
3. **Drought Data**: Drought quality ratings are often located in different columns across years. These are excluded from automated processing.

## Requirements

- **Python 3.x**
- **pandas** and **openpyxl** libraries

To install the required libraries, use `poetry`:

```bash
poetry init
poetry add pandas openpyxl
poetry shell